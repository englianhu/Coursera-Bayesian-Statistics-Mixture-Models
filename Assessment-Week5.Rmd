---
title: "<img src='figure/coursera.jpg' width='37'> <img src='figure/ucsc.png' width='240'>"
subtitle: "<span style='color:white; background-color:#4E79A7;'>Bayesian Statistics: Mixture Models</span> (Assessment Week 5 with Codes)"
author: "[¬ÆŒ≥œÉ, Lian Hu](https://englianhu.github.io/) <img src='figure/quantitative trader 1.jpg' width='12'> <img src='figure/ENG.jpg' width='24'> ¬Æ"
date: "`r lubridate::today('Asia/Tokyo')`"
output:
  html_document: 
    mathjax: https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js
    number_sections: yes
    toc: yes
    toc_depth: 4
    toc_float:
      collapsed: yes
      smooth_scroll: yes
    code_folding: hide
    css: CSSBackgrounds.css
---

<br>
<span style='color:green'>**Theme Song**</span>
<br>

<audio src="music/California-Dreaming-Chorus.mp3" controls></audio>
<br>

------

# Setting

## SCSS Setup

<style>
pre {
  overflow-x: auto;
}
pre code {
  word-wrap: normal;
  white-space: pre;
}
.table-hover > tbody > tr:hover { 
  background-color: #8D918D;
}
</style>

```{r class.source='bg-success', class.output='bg-primary', message = FALSE, warning = FALSE}
# install.packages("remotes")
library('BBmisc', 'rmsfuns')
#remotes::install_github("rstudio/sass")
lib('sass')
```

```{scss class.source='bg-success', class.output='bg-primary'}
/* https://stackoverflow.com/a/66029010/3806250 */
h1 { color: #002C54; }
h2 { color: #2F496E; }
h3 { color: #375E97; }
h4 { color: #556DAC; }
h5 { color: #92AAC7; }

/* ----------------------------------------------------------------- */
/* https://gist.github.com/himynameisdave/c7a7ed14500d29e58149#file-broken-gradient-animation-less */
.hover01 {
  /* color: #FFD64D; */
  background: linear-gradient(155deg, #EDAE01 0%, #FFEB94 100%);
  transition: all 0.45s;
  &:hover{
    background: linear-gradient(155deg, #EDAE01 20%, #FFEB94 80%);
    }
  }

.hover02 {
  color: #FFD64D;
  background: linear-gradient(155deg, #002C54 0%, #4CB5F5 100%);
  transition: all 0.45s;
  &:hover{
    background: linear-gradient(155deg, #002C54 20%, #4CB5F5 80%);
    }
  }

.hover03 {
  color: #FFD64D;
  background: linear-gradient(155deg, #A10115 0%, #FF3C5C 100%);
  transition: all 0.45s;
  &:hover{
    background: linear-gradient(155deg, #A10115 20%, #FF3C5C 80%);
    }
  }
```

```{r global_options, class.source='hover01', class.output='hover02'}
## https://stackoverflow.com/a/36846793/3806250
options(width = 999)
knitr::opts_chunk$set(class.source = 'hover01', class.output = 'hover02', class.error = 'hover03')
```

<br><br>

## Setup

```{r warning=FALSE, message=FALSE}
if(!suppressPackageStartupMessages(require('BBmisc'))) {
  install.packages('BBmisc', dependencies = TRUE, INSTALL_opts = '--no-lock')
}
suppressPackageStartupMessages(require('BBmisc'))
# suppressPackageStartupMessages(require('rmsfuns'))

pkgs <- c('devtools', 'knitr', 'kableExtra', 'tidyr', 
          'readr', 'lubridate', 'reprex', 'magrittr', 
          'timetk', 'plyr', 'dplyr', 'stringr', 
          'tdplyr', 'tidyverse', 'formattable', 
          'echarts4r', 'paletteer')

suppressAll(lib(pkgs))
# load_pkg(pkgs)

## Set the timezone but not change the datetime
Sys.setenv(TZ = 'Asia/Tokyo')
## options(knitr.table.format = 'html') will set all kableExtra tables to be 'html', otherwise need to set the parameter on every single table.
options(warn = -1, knitr.table.format = 'html')#, digits.secs = 6)

## https://stackoverflow.com/questions/39417003/long-vectors-not-supported-yet-abnor-in-rmd-but-not-in-r-script
knitr::opts_chunk$set(message = FALSE, warning = FALSE)#, 
                      #cache = TRUE, cache.lazy = FALSE)

rm(pkgs)
```

<br><br>

# ÂèóË¨õÁîü„Å´„Çà„Çã„ÉÜ„Çπ„ÉàÔºöBIC for zero-inflated mixtures

**Ë™≤È°å„Çí„Åô„Åê„Å´ÊèêÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ**

Ë™≤È°å„ÅÆÊèêÂá∫ÊúüÈôê„ÅØ„ÄÅ`6Êúà21Êó• 15:59 JST`„Åß„Åô„Åå„ÄÅÂèØËÉΩ„Åß„ÅÇ„Çå„Å∞1Êó•„Åã2Êó•Êó©„ÅèÊèêÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ Êó©„ÅÑÊÆµÈöé„ÅßÊèêÂá∫„Åô„Çã„Å®„ÄÅ‰ªñ„ÅÆÂèóË¨õÁîü„ÅÆ„É¨„Éì„É•„Éº„ÇíÊôÇÈñìÂÜÖ„Å´Âæó„ÇãÂèØËÉΩÊÄß„ÅåÈ´ò„Åè„Å™„Çä„Åæ„Åô„ÄÇ

## Ë™¨Êòé

In week 2, you considered the problem faced by a biologist is interest in characterizing the number of eggs laid by a particular bird species. The data consisted of a sample $n=300$ nests on a site in Southern California, which were contained in the file `nestsize.csv`:

[`nestsize.csv`](https://github.com/englianhu/Coursera-Bayesian-Statistics-Mixture-Models/blob/main/data/nestsize.csv)

At the time we visually compared the empirical distribution of the data against a Poison distribution whose parameter has been set to its maximum likelihood estimator as a justification for using a mixture model of the form $f(x) = w \delta_0(x) + (1-w) \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$ where $\delta_0(x)$ represents the degenerate distribution placing all of its mass at zero.

![](figure/zeroinflated2.png)

You are asked to build on the EM algorithm you constructed in week 2 to compute the BIC associated with this model and contrast it against the BIC for the simpler Poisson model. 

<br><br>

### Review criteria

You will be asked to provide (1) code to compute the BIC for the zero-inflated mixture (which requires an EM algorithm),(2) code to compute the BIC for the Poisson model (which does not require an EM algorithm),(3) provide numerical results for the BIC for each of the two models, and (4) interpret the results in terms of the original problem.

<br><br>

## Ëá™ÂàÜ„ÅÆÊèêÂá∫Áâ©

### Assignment

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

(Note that you can think about this model as a mixture with a single component).

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = w \delta_0(x) + (1-w) \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?

```{r error=TRUE}

```

### Marking

**Is the number of effective parameters correct?**

This model has only 1 parameter (the rate $\lambda$).

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the MLE computed correctly for the Poisson model?**

The MLE for the Poisson model can be obtained analytically and does not require the use of any numerical optimization algorithm. In this case $\hat{\lambda}=\bar{x}$, the average of the observations, is the MLE.
 
```{r error=TRUE}
lambdahat = mean(x)
n = length(x)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the negative log-likelihood evaluated at the MLE computed correctly for the Poisson model?**

The likelihood function in this case is 

$$-2\log L(\lambda) = 2n \bar{x} - 2n\bar{x} \log \bar{x} + 2 \sum_{i=1}^{n} \log x_i !$$

The following R code performs the evaluation:

```{r error=TRUE}
twicenegloglik = 2*n*lambdahat - 2*n*lambdahat*log(lambdahat) + 2*sum(lfactorial(x))
```

Alternatively, you can use the built in functions to evaluate the density of the Poisson distribution,

```{r error=TRUE}
twicenegloglik = -2*sum(dpois(x,lambdahat,log=T))
```

When grading, please remember that there are many ways to do the same thing in R

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the numerical value for the dataset nestsize.csv BIC correct? **

In this case, the MLEs are (rounded to 2 decimal places) $\omega =0.40$ and $3.07$ (you had already obtained these values in week 2).  This leads to a value of the BIC equal to $1056.85$ (rounded to two decimal places)..

```{r error=TRUE}
BIC2 = twicenegloglik + 2*log(n)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?**

Yes, the BIC for the mixture model is smaller than the BIC for the simpler Poisson model.  This supports our original observation based on graphical evidence that the mixture model is more appropriate for this data than the simpler Poisson model.

- 0ÁÇπ No
- 1ÁÇπ Yes

<br><br>

## „Éî„Ç¢„É¨„Éì„É•„Éº

### 1st Peer

#### Assignment

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

(Note that you can think about this model as a mixture with a single component).

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = w \delta_0(x) + (1-w) \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?

```{r error=TRUE}

```

#### Marking

**Is the number of effective parameters correct?**

This model has only 1 parameter (the rate $\lambda$).

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the MLE computed correctly for the Poisson model?**

The MLE for the Poisson model can be obtained analytically and does not require the use of any numerical optimization algorithm. In this case $\hat{\lambda}=\bar{x}$, the average of the observations, is the MLE.
 
```{r error=TRUE}
lambdahat = mean(x)
n = length(x)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the negative log-likelihood evaluated at the MLE computed correctly for the Poisson model?**

The likelihood function in this case is 

$$-2\log L(\lambda) = 2n \bar{x} - 2n\bar{x} \log \bar{x} + 2 \sum_{i=1}^{n} \log x_i !$$

The following R code performs the evaluation:

```{r error=TRUE}
twicenegloglik = 2*n*lambdahat - 2*n*lambdahat*log(lambdahat) + 2*sum(lfactorial(x))
```

Alternatively, you can use the built in functions to evaluate the density of the Poisson distribution,

```{r error=TRUE}
twicenegloglik = -2*sum(dpois(x,lambdahat,log=T))
```

When grading, please remember that there are many ways to do the same thing in R

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the numerical value for the dataset nestsize.csv BIC correct? **

In this case, the MLEs are (rounded to 2 decimal places) $\omega =0.40$ and $3.07$ (you had already obtained these values in week 2).  This leads to a value of the BIC equal to $1056.85$ (rounded to two decimal places)..

```{r error=TRUE}
BIC2 = twicenegloglik + 2*log(n)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?**

Yes, the BIC for the mixture model is smaller than the BIC for the simpler Poisson model.  This supports our original observation based on graphical evidence that the mixture model is more appropriate for this data than the simpler Poisson model.

- 0ÁÇπ No
- 1ÁÇπ Yes

<br>

### 2nd Peer

#### Assignment

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

(Note that you can think about this model as a mixture with a single component).

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = w \delta_0(x) + (1-w) \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?

```{r error=TRUE}

```

#### Marking

**Is the number of effective parameters correct?**

This model has only 1 parameter (the rate $\lambda$).

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the MLE computed correctly for the Poisson model?**

The MLE for the Poisson model can be obtained analytically and does not require the use of any numerical optimization algorithm. In this case $\hat{\lambda}=\bar{x}$, the average of the observations, is the MLE.
 
```{r error=TRUE}
lambdahat = mean(x)
n = length(x)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the negative log-likelihood evaluated at the MLE computed correctly for the Poisson model?**

The likelihood function in this case is 

$$-2\log L(\lambda) = 2n \bar{x} - 2n\bar{x} \log \bar{x} + 2 \sum_{i=1}^{n} \log x_i !$$

The following R code performs the evaluation:

```{r error=TRUE}
twicenegloglik = 2*n*lambdahat - 2*n*lambdahat*log(lambdahat) + 2*sum(lfactorial(x))
```

Alternatively, you can use the built in functions to evaluate the density of the Poisson distribution,

```{r error=TRUE}
twicenegloglik = -2*sum(dpois(x,lambdahat,log=T))
```

When grading, please remember that there are many ways to do the same thing in R

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the numerical value for the dataset nestsize.csv BIC correct? **

In this case, the MLEs are (rounded to 2 decimal places) $\omega =0.40$ and $3.07$ (you had already obtained these values in week 2).  This leads to a value of the BIC equal to $1056.85$ (rounded to two decimal places)..

```{r error=TRUE}
BIC2 = twicenegloglik + 2*log(n)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?**

Yes, the BIC for the mixture model is smaller than the BIC for the simpler Poisson model.  This supports our original observation based on graphical evidence that the mixture model is more appropriate for this data than the simpler Poisson model.

- 0ÁÇπ No
- 1ÁÇπ Yes

<br>

### 3rd Peer

#### Assignment

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

(Note that you can think about this model as a mixture with a single component).

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = w \delta_0(x) + (1-w) \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?

```{r error=TRUE}

```

#### Marking

**Is the number of effective parameters correct?**

This model has only 1 parameter (the rate $\lambda$).

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the MLE computed correctly for the Poisson model?**

The MLE for the Poisson model can be obtained analytically and does not require the use of any numerical optimization algorithm. In this case $\hat{\lambda}=\bar{x}$, the average of the observations, is the MLE.
 
```{r error=TRUE}
lambdahat = mean(x)
n = length(x)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the negative log-likelihood evaluated at the MLE computed correctly for the Poisson model?**

The likelihood function in this case is 

$$-2\log L(\lambda) = 2n \bar{x} - 2n\bar{x} \log \bar{x} + 2 \sum_{i=1}^{n} \log x_i !$$

The following R code performs the evaluation:

```{r error=TRUE}
twicenegloglik = 2*n*lambdahat - 2*n*lambdahat*log(lambdahat) + 2*sum(lfactorial(x))
```

Alternatively, you can use the built in functions to evaluate the density of the Poisson distribution,

```{r error=TRUE}
twicenegloglik = -2*sum(dpois(x,lambdahat,log=T))
```

When grading, please remember that there are many ways to do the same thing in R

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the numerical value for the dataset nestsize.csv BIC correct? **

In this case, the MLEs are (rounded to 2 decimal places) $\omega =0.40$ and $3.07$ (you had already obtained these values in week 2).  This leads to a value of the BIC equal to $1056.85$ (rounded to two decimal places)..

```{r error=TRUE}
BIC2 = twicenegloglik + 2*log(n)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?**

Yes, the BIC for the mixture model is smaller than the BIC for the simpler Poisson model.  This supports our original observation based on graphical evidence that the mixture model is more appropriate for this data than the simpler Poisson model.

- 0ÁÇπ No
- 1ÁÇπ Yes

<br>

### 4th Peer

#### Assignment

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

(Note that you can think about this model as a mixture with a single component).

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = w \delta_0(x) + (1-w) \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?

```{r error=TRUE}

```

#### Marking

**Is the number of effective parameters correct?**

This model has only 1 parameter (the rate $\lambda$).

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the MLE computed correctly for the Poisson model?**

The MLE for the Poisson model can be obtained analytically and does not require the use of any numerical optimization algorithm. In this case $\hat{\lambda}=\bar{x}$, the average of the observations, is the MLE.
 
```{r error=TRUE}
lambdahat = mean(x)
n = length(x)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the negative log-likelihood evaluated at the MLE computed correctly for the Poisson model?**

The likelihood function in this case is 

$$-2\log L(\lambda) = 2n \bar{x} - 2n\bar{x} \log \bar{x} + 2 \sum_{i=1}^{n} \log x_i !$$

The following R code performs the evaluation:

```{r error=TRUE}
twicenegloglik = 2*n*lambdahat - 2*n*lambdahat*log(lambdahat) + 2*sum(lfactorial(x))
```

Alternatively, you can use the built in functions to evaluate the density of the Poisson distribution,

```{r error=TRUE}
twicenegloglik = -2*sum(dpois(x,lambdahat,log=T))
```

When grading, please remember that there are many ways to do the same thing in R

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the numerical value for the dataset nestsize.csv BIC correct? **

In this case, the MLEs are (rounded to 2 decimal places) $\omega =0.40$ and $3.07$ (you had already obtained these values in week 2).  This leads to a value of the BIC equal to $1056.85$ (rounded to two decimal places)..

```{r error=TRUE}
BIC2 = twicenegloglik + 2*log(n)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?**

Yes, the BIC for the mixture model is smaller than the BIC for the simpler Poisson model.  This supports our original observation based on graphical evidence that the mixture model is more appropriate for this data than the simpler Poisson model.

- 0ÁÇπ No
- 1ÁÇπ Yes

<br>

### 5th Peer

#### Assignment

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

(Note that you can think about this model as a mixture with a single component).

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = w \delta_0(x) + (1-w) \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?

```{r error=TRUE}

```

#### Marking

**Is the number of effective parameters correct?**

This model has only 1 parameter (the rate $\lambda$).

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the MLE computed correctly for the Poisson model?**

The MLE for the Poisson model can be obtained analytically and does not require the use of any numerical optimization algorithm. In this case $\hat{\lambda}=\bar{x}$, the average of the observations, is the MLE.
 
```{r error=TRUE}
lambdahat = mean(x)
n = length(x)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the negative log-likelihood evaluated at the MLE computed correctly for the Poisson model?**

The likelihood function in this case is 

$$-2\log L(\lambda) = 2n \bar{x} - 2n\bar{x} \log \bar{x} + 2 \sum_{i=1}^{n} \log x_i !$$

The following R code performs the evaluation:

```{r error=TRUE}
twicenegloglik = 2*n*lambdahat - 2*n*lambdahat*log(lambdahat) + 2*sum(lfactorial(x))
```

Alternatively, you can use the built in functions to evaluate the density of the Poisson distribution,

```{r error=TRUE}
twicenegloglik = -2*sum(dpois(x,lambdahat,log=T))
```

When grading, please remember that there are many ways to do the same thing in R

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the numerical value for the dataset nestsize.csv BIC correct? **

In this case, the MLEs are (rounded to 2 decimal places) $\omega =0.40$ and $3.07$ (you had already obtained these values in week 2).  This leads to a value of the BIC equal to $1056.85$ (rounded to two decimal places)..

```{r error=TRUE}
BIC2 = twicenegloglik + 2*log(n)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?**

Yes, the BIC for the mixture model is smaller than the BIC for the simpler Poisson model.  This supports our original observation based on graphical evidence that the mixture model is more appropriate for this data than the simpler Poisson model.

- 0ÁÇπ No
- 1ÁÇπ Yes

<br>

### 6th Peer

#### Assignment

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

(Note that you can think about this model as a mixture with a single component).

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = w \delta_0(x) + (1-w) \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?

```{r error=TRUE}

```

#### Marking

**Is the number of effective parameters correct?**

This model has only 1 parameter (the rate $\lambda$).

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the MLE computed correctly for the Poisson model?**

The MLE for the Poisson model can be obtained analytically and does not require the use of any numerical optimization algorithm. In this case $\hat{\lambda}=\bar{x}$, the average of the observations, is the MLE.
 
```{r error=TRUE}
lambdahat = mean(x)
n = length(x)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the negative log-likelihood evaluated at the MLE computed correctly for the Poisson model?**

The likelihood function in this case is 

$$-2\log L(\lambda) = 2n \bar{x} - 2n\bar{x} \log \bar{x} + 2 \sum_{i=1}^{n} \log x_i !$$

The following R code performs the evaluation:

```{r error=TRUE}
twicenegloglik = 2*n*lambdahat - 2*n*lambdahat*log(lambdahat) + 2*sum(lfactorial(x))
```

Alternatively, you can use the built in functions to evaluate the density of the Poisson distribution,

```{r error=TRUE}
twicenegloglik = -2*sum(dpois(x,lambdahat,log=T))
```

When grading, please remember that there are many ways to do the same thing in R

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the numerical value for the dataset nestsize.csv BIC correct? **

In this case, the MLEs are (rounded to 2 decimal places) $\omega =0.40$ and $3.07$ (you had already obtained these values in week 2).  This leads to a value of the BIC equal to $1056.85$ (rounded to two decimal places)..

```{r error=TRUE}
BIC2 = twicenegloglik + 2*log(n)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?**

Yes, the BIC for the mixture model is smaller than the BIC for the simpler Poisson model.  This supports our original observation based on graphical evidence that the mixture model is more appropriate for this data than the simpler Poisson model.

- 0ÁÇπ No
- 1ÁÇπ Yes

<br>

### 7th Peer

#### Assignment

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

(Note that you can think about this model as a mixture with a single component).

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = w \delta_0(x) + (1-w) \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?

```{r error=TRUE}

```

#### Marking

**Is the number of effective parameters correct?**

This model has only 1 parameter (the rate $\lambda$).

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the MLE computed correctly for the Poisson model?**

The MLE for the Poisson model can be obtained analytically and does not require the use of any numerical optimization algorithm. In this case $\hat{\lambda}=\bar{x}$, the average of the observations, is the MLE.
 
```{r error=TRUE}
lambdahat = mean(x)
n = length(x)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the negative log-likelihood evaluated at the MLE computed correctly for the Poisson model?**

The likelihood function in this case is 

$$-2\log L(\lambda) = 2n \bar{x} - 2n\bar{x} \log \bar{x} + 2 \sum_{i=1}^{n} \log x_i !$$

The following R code performs the evaluation:

```{r error=TRUE}
twicenegloglik = 2*n*lambdahat - 2*n*lambdahat*log(lambdahat) + 2*sum(lfactorial(x))
```

Alternatively, you can use the built in functions to evaluate the density of the Poisson distribution,

```{r error=TRUE}
twicenegloglik = -2*sum(dpois(x,lambdahat,log=T))
```

When grading, please remember that there are many ways to do the same thing in R

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the numerical value for the dataset nestsize.csv BIC correct? **

In this case, the MLEs are (rounded to 2 decimal places) $\omega =0.40$ and $3.07$ (you had already obtained these values in week 2).  This leads to a value of the BIC equal to $1056.85$ (rounded to two decimal places)..

```{r error=TRUE}
BIC2 = twicenegloglik + 2*log(n)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?**

Yes, the BIC for the mixture model is smaller than the BIC for the simpler Poisson model.  This supports our original observation based on graphical evidence that the mixture model is more appropriate for this data than the simpler Poisson model.

- 0ÁÇπ No
- 1ÁÇπ Yes

<br>

### 8th Peer

#### Assignment

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

(Note that you can think about this model as a mixture with a single component).

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = w \delta_0(x) + (1-w) \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?

```{r error=TRUE}

```

#### Marking

**Is the number of effective parameters correct?**

This model has only 1 parameter (the rate $\lambda$).

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the MLE computed correctly for the Poisson model?**

The MLE for the Poisson model can be obtained analytically and does not require the use of any numerical optimization algorithm. In this case $\hat{\lambda}=\bar{x}$, the average of the observations, is the MLE.
 
```{r error=TRUE}
lambdahat = mean(x)
n = length(x)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the negative log-likelihood evaluated at the MLE computed correctly for the Poisson model?**

The likelihood function in this case is 

$$-2\log L(\lambda) = 2n \bar{x} - 2n\bar{x} \log \bar{x} + 2 \sum_{i=1}^{n} \log x_i !$$

The following R code performs the evaluation:

```{r error=TRUE}
twicenegloglik = 2*n*lambdahat - 2*n*lambdahat*log(lambdahat) + 2*sum(lfactorial(x))
```

Alternatively, you can use the built in functions to evaluate the density of the Poisson distribution,

```{r error=TRUE}
twicenegloglik = -2*sum(dpois(x,lambdahat,log=T))
```

When grading, please remember that there are many ways to do the same thing in R

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the numerical value for the dataset nestsize.csv BIC correct? **

In this case, the MLEs are (rounded to 2 decimal places) $\omega =0.40$ and $3.07$ (you had already obtained these values in week 2).  This leads to a value of the BIC equal to $1056.85$ (rounded to two decimal places)..

```{r error=TRUE}
BIC2 = twicenegloglik + 2*log(n)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?**

Yes, the BIC for the mixture model is smaller than the BIC for the simpler Poisson model.  This supports our original observation based on graphical evidence that the mixture model is more appropriate for this data than the simpler Poisson model.

- 0ÁÇπ No
- 1ÁÇπ Yes

<br>

### 9th Peer

#### Assignment

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

(Note that you can think about this model as a mixture with a single component).

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = w \delta_0(x) + (1-w) \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?

```{r error=TRUE}

```

#### Marking

**Is the number of effective parameters correct?**

This model has only 1 parameter (the rate $\lambda$).

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the MLE computed correctly for the Poisson model?**

The MLE for the Poisson model can be obtained analytically and does not require the use of any numerical optimization algorithm. In this case $\hat{\lambda}=\bar{x}$, the average of the observations, is the MLE.
 
```{r error=TRUE}
lambdahat = mean(x)
n = length(x)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the negative log-likelihood evaluated at the MLE computed correctly for the Poisson model?**

The likelihood function in this case is 

$$-2\log L(\lambda) = 2n \bar{x} - 2n\bar{x} \log \bar{x} + 2 \sum_{i=1}^{n} \log x_i !$$

The following R code performs the evaluation:

```{r error=TRUE}
twicenegloglik = 2*n*lambdahat - 2*n*lambdahat*log(lambdahat) + 2*sum(lfactorial(x))
```

Alternatively, you can use the built in functions to evaluate the density of the Poisson distribution,

```{r error=TRUE}
twicenegloglik = -2*sum(dpois(x,lambdahat,log=T))
```

When grading, please remember that there are many ways to do the same thing in R

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the numerical value for the dataset nestsize.csv BIC correct? **

In this case, the MLEs are (rounded to 2 decimal places) $\omega =0.40$ and $3.07$ (you had already obtained these values in week 2).  This leads to a value of the BIC equal to $1056.85$ (rounded to two decimal places)..

```{r error=TRUE}
BIC2 = twicenegloglik + 2*log(n)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?**

Yes, the BIC for the mixture model is smaller than the BIC for the simpler Poisson model.  This supports our original observation based on graphical evidence that the mixture model is more appropriate for this data than the simpler Poisson model.

- 0ÁÇπ No
- 1ÁÇπ Yes

<br>

### 10th Peer

#### Assignment

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

(Note that you can think about this model as a mixture with a single component).

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Derive the formula for the BIC associated with the the Poisson model

$$f(x) = w \delta_0(x) + (1-w) \frac{e^{-\lambda} \lambda^x}{x!} \quad \quad x \in \{0,1,2,\ldots\}$$

Then, provide code to compute the BIC and use it to evaluate it for the dataset `nestsize.csv`:

```{r error=TRUE}

```

Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?

```{r error=TRUE}

```

#### Marking

**Is the number of effective parameters correct?**

This model has only 1 parameter (the rate $\lambda$).

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the MLE computed correctly for the Poisson model?**

The MLE for the Poisson model can be obtained analytically and does not require the use of any numerical optimization algorithm. In this case $\hat{\lambda}=\bar{x}$, the average of the observations, is the MLE.
 
```{r error=TRUE}
lambdahat = mean(x)
n = length(x)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the negative log-likelihood evaluated at the MLE computed correctly for the Poisson model?**

The likelihood function in this case is 

$$-2\log L(\lambda) = 2n \bar{x} - 2n\bar{x} \log \bar{x} + 2 \sum_{i=1}^{n} \log x_i !$$

The following R code performs the evaluation:

```{r error=TRUE}
twicenegloglik = 2*n*lambdahat - 2*n*lambdahat*log(lambdahat) + 2*sum(lfactorial(x))
```

Alternatively, you can use the built in functions to evaluate the density of the Poisson distribution,

```{r error=TRUE}
twicenegloglik = -2*sum(dpois(x,lambdahat,log=T))
```

When grading, please remember that there are many ways to do the same thing in R

- 0ÁÇπ No
- 1ÁÇπ Yes

**Is the numerical value for the dataset nestsize.csv BIC correct? **

In this case, the MLEs are (rounded to 2 decimal places) $\omega =0.40$ and $3.07$ (you had already obtained these values in week 2).  This leads to a value of the BIC equal to $1056.85$ (rounded to two decimal places)..

```{r error=TRUE}
BIC2 = twicenegloglik + 2*log(n)
```

- 0ÁÇπ No
- 1ÁÇπ Yes

**Does the BIC provide evidence for the mixture model in the `nestsize.csv` dataset?**

Yes, the BIC for the mixture model is smaller than the BIC for the simpler Poisson model.  This supports our original observation based on graphical evidence that the mixture model is more appropriate for this data than the simpler Poisson model.

- 0ÁÇπ No
- 1ÁÇπ Yes

<br><br>

## „Éá„Ç£„Çπ„Ç´„ÉÉ„Ç∑„Éß„É≥

<br><br>

# Appendix

## Blooper

## Documenting File Creation 

It's useful to record some information about how your file was created.

- File creation date: 2021-05-28
- File latest updated date: `r today('Asia/Tokyo')`
- `r R.version.string`
- [**rmarkdown** package](https://github.com/rstudio/rmarkdown) version: `r packageVersion('rmarkdown')`
- File version: 1.0.0
- Author Profile: [¬ÆŒ≥œÉ, Eng Lian Hu](https://github.com/scibrokes/owner)
- GitHub: [Source Code](https://github.com/englianhu/coursera-bayesian-statistics-mixture-models)
- Additional session information:

```{r info, warning=FALSE, error=TRUE, results='asis'}
suppressMessages(require('dplyr', quietly = TRUE))
suppressMessages(require('magrittr', quietly = TRUE))
suppressMessages(require('formattable', quietly = TRUE))
suppressMessages(require('knitr', quietly = TRUE))
suppressMessages(require('kableExtra', quietly = TRUE))

sys1 <- devtools::session_info()$platform %>% 
  unlist %>% data.frame(Category = names(.), session_info = .)
rownames(sys1) <- NULL

sys2 <- data.frame(Sys.info()) %>% 
  dplyr::mutate(Category = rownames(.)) %>% .[2:1]
names(sys2)[2] <- c('Sys.info')
rownames(sys2) <- NULL

if (nrow(sys1) == 9 & nrow(sys2) == 8) {
  sys2 %<>% rbind(., data.frame(
  Category = 'Current time', 
  Sys.info = paste(as.character(lubridate::now('Asia/Tokyo')), 'JSTüóæ')))
} else {
  sys1 %<>% rbind(., data.frame(
  Category = 'Current time', 
  session_info = paste(as.character(lubridate::now('Asia/Tokyo')), 'JSTüóæ')))
}

sys <- cbind(sys1, sys2) %>% 
  kbl(caption = 'Additional session information:') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue', color = 'red') %>% 
  column_spec(2, background = 'grey', color = 'black') %>% 
  column_spec(3, background = 'CornflowerBlue', color = 'blue') %>% 
  column_spec(4, background = 'grey', color = 'white') %>% 
  row_spec(9, bold = T, color = 'yellow', background = '#D7261E')

rm(sys1, sys2)
sys
```

## Reference

<br><br>
